<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScript Modules & Testing Demo</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #0f0f0f;
        color: #f8f9fa;
        line-height: 1.6;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        padding: 40px 20px;
        background: linear-gradient(135deg, #20c997 0%, #0056b3 100%);
        border-radius: 20px;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 3em;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.2em;
        opacity: 0.9;
      }

      .demo-section {
        background: #1a1a1a;
        margin: 40px 0;
        padding: 30px;
        border-radius: 15px;
        border: 1px solid #333;
      }

      .demo-section h2 {
        color: #20c997;
        margin-bottom: 25px;
        font-size: 2em;
        text-align: center;
        position: relative;
      }

      .demo-section h2::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 3px;
        background: linear-gradient(90deg, #20c997, #0056b3);
      }

      .module-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        margin: 30px 0;
      }

      .module-card {
        background: #2a2a2a;
        padding: 25px;
        border-radius: 12px;
        border: 1px solid #444;
        transition: all 0.3s ease;
      }

      .module-card:hover {
        border-color: #20c997;
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(32, 201, 151, 0.2);
      }

      .module-card h3 {
        color: #20c997;
        margin-bottom: 15px;
        font-size: 1.4em;
      }

      .code-block {
        background: #0d1117;
        border: 1px solid #30363d;
        border-radius: 8px;
        padding: 20px;
        margin: 15px 0;
        font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
        font-size: 14px;
        overflow-x: auto;
        position: relative;
        white-space: pre-wrap;
        line-height: 1.5;
      }

      .code-block::before {
        content: attr(data-lang);
        position: absolute;
        top: 5px;
        right: 10px;
        font-size: 12px;
        color: #7d8590;
        text-transform: uppercase;
      }

      .js-keyword {
        color: #ff7b72;
      }
      .js-string {
        color: #a5d6ff;
      }
      .js-method {
        color: #d2a8ff;
      }
      .js-comment {
        color: #8b949e;
      }
      .js-number {
        color: #79c0ff;
      }
      .js-operator {
        color: #ff7b72;
      }
      .js-param {
        color: #ffa657;
      }
      .js-export {
        color: #3fb950;
      }
      .js-import {
        color: #58a6ff;
      }

      .interactive-demo {
        background: #2a2a2a;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border-left: 4px solid #20c997;
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin: 20px 0;
        align-items: center;
      }

      .btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        background: #20c997;
        color: white;
      }

      .btn:hover {
        background: #1ba085;
        transform: translateY(-2px);
      }

      .btn-secondary {
        background: #6c757d;
      }

      .btn-secondary:hover {
        background: #545b62;
      }

      .btn-danger {
        background: #dc3545;
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .btn-success {
        background: #28a745;
      }

      .btn-success:hover {
        background: #218838;
      }

      .output {
        background: #0d1117;
        border: 1px solid #30363d;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 13px;
        margin: 15px 0;
        min-height: 120px;
        overflow-y: auto;
        max-height: 400px;
      }

      .output-line {
        margin: 5px 0;
        padding: 2px 0;
      }

      .success {
        color: #3fb950;
      }
      .error {
        color: #f85149;
      }
      .info {
        color: #58a6ff;
      }
      .warning {
        color: #d29922;
      }
      .test-pass {
        color: #3fb950;
      }
      .test-fail {
        color: #f85149;
      }
      .test-skip {
        color: #d29922;
      }

      input[type='text'],
      input[type='number'],
      textarea,
      select {
        padding: 10px;
        border: 2px solid #30363d;
        border-radius: 6px;
        background: #0d1117;
        color: #f8f9fa;
        font-size: 14px;
        margin: 0 10px 10px 0;
        min-width: 200px;
      }

      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: #20c997;
      }

      .module-structure {
        background: #2a2a2a;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border: 2px solid #20c997;
      }

      .file-tree {
        font-family: monospace;
        font-size: 14px;
        margin: 15px 0;
      }

      .file-tree .folder {
        color: #58a6ff;
        font-weight: bold;
      }

      .file-tree .file {
        color: #f8f9fa;
      }

      .file-tree .indent {
        margin-left: 20px;
      }

      .test-suite {
        background: #1a1a1a;
        border: 1px solid #30363d;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .test-result {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        margin: 5px 0;
        border-radius: 6px;
        font-family: monospace;
      }

      .test-result.pass {
        background: #0f2419;
        border-left: 4px solid #3fb950;
      }

      .test-result.fail {
        background: #2d1117;
        border-left: 4px solid #f85149;
      }

      .test-result.skip {
        background: #3d2914;
        border-left: 4px solid #d29922;
      }

      .test-summary {
        background: #2a2a2a;
        padding: 15px;
        border-radius: 6px;
        margin: 20px 0;
        text-align: center;
      }

      .coverage-bar {
        width: 100%;
        height: 20px;
        background: #30363d;
        border-radius: 10px;
        overflow: hidden;
        margin: 10px 0;
      }

      .coverage-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          #f85149 0%,
          #d29922 50%,
          #3fb950 100%
        );
        transition: width 0.3s ease;
      }

      .dependency-graph {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin: 20px 0;
      }

      .module-node {
        background: #2a2a2a;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #20c997;
        position: relative;
      }

      .module-node::after {
        content: '';
        position: absolute;
        bottom: -15px;
        left: 50%;
        width: 2px;
        height: 15px;
        background: #20c997;
      }

      .module-node:last-child::after {
        display: none;
      }

      .tip-box {
        background: #1f2328;
        border: 1px solid #20c997;
        border-left: 4px solid #20c997;
        padding: 20px;
        border-radius: 6px;
        margin: 20px 0;
      }

      .tip-box h4 {
        color: #20c997;
        margin-bottom: 10px;
      }

      @media (max-width: 768px) {
        .module-grid {
          grid-template-columns: 1fr;
        }

        .controls {
          flex-direction: column;
          align-items: stretch;
        }

        input[type='text'],
        input[type='number'] {
          min-width: auto;
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üì¶ JavaScript Modules & Testing</h1>
        <p>
          Learn ES6 modules, import/export patterns, and modern testing
          techniques
        </p>
      </div>

      <!-- ES6 Modules -->
      <div class="demo-section">
        <h2>üìö ES6 Modules & Import/Export</h2>

        <div class="module-structure">
          <h3>Project Structure</h3>
          <div class="file-tree">
            <div class="folder">üìÅ src/</div>
            <div class="indent">
              <div class="file">üìÑ main.js</div>
              <div class="file">üìÑ utils.js</div>
              <div class="file">üìÑ math.js</div>
              <div class="file">üìÑ api.js</div>
              <div class="folder">üìÅ components/</div>
              <div class="indent">
                <div class="file">üìÑ Button.js</div>
                <div class="file">üìÑ Modal.js</div>
              </div>
            </div>
          </div>
        </div>

        <div class="module-grid">
          <div class="module-card">
            <h3>Export Patterns</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// math.js - Named exports</span>
              <span class="js-export">export</span>
              <span class="js-keyword">const</span>
              <span class="js-method">add</span> = (<span class="js-param"
                >a</span
              >, <span class="js-param">b</span>)
              <span class="js-operator">=></span> a + b;
              <span class="js-export">export</span>
              <span class="js-keyword">const</span>
              <span class="js-method">multiply</span> = (<span class="js-param"
                >a</span
              >, <span class="js-param">b</span>)
              <span class="js-operator">=></span> a * b;

              <span class="js-keyword">const</span>
              <span class="js-method">divide</span> = (<span class="js-param"
                >a</span
              >, <span class="js-param">b</span>)
              <span class="js-operator">=></span> {
              <span class="js-keyword">if</span> (b ===
              <span class="js-number">0</span>)
              <span class="js-keyword">throw new</span>
              <span class="js-method">Error</span>(<span class="js-string"
                >'Division by zero'</span
              >); <span class="js-keyword">return</span> a / b; };

              <span class="js-comment">// Export after declaration</span>
              <span class="js-export">export</span> { divide };

              <span class="js-comment">// Default export</span>
              <span class="js-keyword">class</span>
              <span class="js-method">Calculator</span> {
              <span class="js-method">constructor</span>() {
              <span class="js-keyword">this</span>.history = []; }

              <span class="js-method">calculate</span>(<span class="js-param"
                >operation</span
              >, <span class="js-param">a</span>,
              <span class="js-param">b</span>) {
              <span class="js-keyword">const</span> result = operation(a, b);
              <span class="js-keyword">this</span>.history.<span
                class="js-method"
                >push</span
              >({ operation: operation.name, a, b, result });
              <span class="js-keyword">return</span> result; } }

              <span class="js-export">export default</span> Calculator;
            </div>
          </div>

          <div class="module-card">
            <h3>Import Patterns</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment"
                >// main.js - Various import patterns</span
              >

              <span class="js-comment">// Named imports</span>
              <span class="js-import">import</span> { add, multiply, divide }
              <span class="js-import">from</span>
              <span class="js-string">'./math.js'</span>;

              <span class="js-comment">// Default import</span>
              <span class="js-import">import</span> Calculator
              <span class="js-import">from</span>
              <span class="js-string">'./math.js'</span>;

              <span class="js-comment">// Mixed imports</span>
              <span class="js-import">import</span> Calculator, { add, multiply
              } <span class="js-import">from</span>
              <span class="js-string">'./math.js'</span>;

              <span class="js-comment">// Namespace import</span>
              <span class="js-import">import</span> *
              <span class="js-import">as</span> MathUtils
              <span class="js-import">from</span>
              <span class="js-string">'./math.js'</span>;

              <span class="js-comment">// Renamed imports</span>
              <span class="js-import">import</span> { add
              <span class="js-import">as</span> sum, multiply
              <span class="js-import">as</span> product }
              <span class="js-import">from</span>
              <span class="js-string">'./math.js'</span>;

              <span class="js-comment">// Dynamic imports</span>
              <span class="js-keyword">const</span> mathModule =
              <span class="js-keyword">await</span>
              <span class="js-import">import</span>(<span class="js-string"
                >'./math.js'</span
              >); <span class="js-keyword">const</span> { add } =
              <span class="js-keyword">await</span>
              <span class="js-import">import</span>(<span class="js-string"
                >'./math.js'</span
              >);

              <span class="js-comment">// Conditional imports</span>
              <span class="js-keyword">if</span> (needsAdvancedMath) {
              <span class="js-keyword">const</span> { complexCalculation } =
              <span class="js-keyword">await</span>
              <span class="js-import">import</span>(<span class="js-string"
                >'./advanced-math.js'</span
              >); }
            </div>
          </div>
        </div>

        <div class="interactive-demo">
          <h4>Module Simulator</h4>
          <div class="controls">
            <input
              type="text"
              id="module-name"
              placeholder="Module name"
              value="myModule"
            />
            <select id="export-type">
              <option value="named">Named Export</option>
              <option value="default">Default Export</option>
              <option value="mixed">Mixed Exports</option>
            </select>
            <button class="btn" onclick="generateModule()">
              Generate Module
            </button>
            <button
              class="btn btn-secondary"
              onclick="clearOutput('module-output')"
            >
              Clear
            </button>
          </div>
          <div class="output" id="module-output"></div>
        </div>
      </div>

      <!-- Module Dependencies -->
      <div class="demo-section">
        <h2>üîó Module Dependencies & Patterns</h2>

        <div class="dependency-graph">
          <div class="module-node">
            <strong>main.js</strong> - Entry point, imports from all modules
          </div>
          <div class="module-node">
            <strong>utils.js</strong> - Utility functions, no dependencies
          </div>
          <div class="module-node">
            <strong>api.js</strong> - API layer, imports utils
          </div>
          <div class="module-node">
            <strong>components/</strong> - UI components, import utils and api
          </div>
        </div>

        <div class="module-grid">
          <div class="module-card">
            <h3>Circular Dependencies</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// ‚ùå Avoid circular dependencies</span>
              <span class="js-comment">// a.js</span>
              <span class="js-import">import</span> { functionB }
              <span class="js-import">from</span>
              <span class="js-string">'./b.js'</span>;
              <span class="js-export">export</span>
              <span class="js-keyword">const</span>
              <span class="js-method">functionA</span> = ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">return</span>
              <span class="js-method">functionB</span>() +
              <span class="js-string">' from A'</span>; };

              <span class="js-comment">// b.js</span>
              <span class="js-import">import</span> { functionA }
              <span class="js-import">from</span>
              <span class="js-string">'./a.js'</span>;
              <span class="js-comment">// ‚ùå Circular!</span>
              <span class="js-export">export</span>
              <span class="js-keyword">const</span>
              <span class="js-method">functionB</span> = ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">return</span>
              <span class="js-string">'Hello from B'</span>; };

              <span class="js-comment">// ‚úÖ Better: Extract shared logic</span>
              <span class="js-comment">// shared.js</span>
              <span class="js-export">export</span>
              <span class="js-keyword">const</span>
              <span class="js-method">sharedFunction</span> = ()
              <span class="js-operator">=></span>
              <span class="js-string">'Shared logic'</span>;

              <span class="js-comment"
                >// a.js & b.js both import from shared.js</span
              >
            </div>
          </div>

          <div class="module-card">
            <h3>Module Bundling Concepts</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment"
                >// Tree shaking - only imports used code</span
              >
              <span class="js-import">import</span> { debounce }
              <span class="js-import">from</span>
              <span class="js-string">'lodash'</span>;
              <span class="js-comment">// ‚ùå Imports entire library</span>
              <span class="js-import">import</span> debounce
              <span class="js-import">from</span>
              <span class="js-string">'lodash/debounce'</span>;
              <span class="js-comment">// ‚úÖ Only imports debounce</span>

              <span class="js-comment"
                >// Code splitting with dynamic imports</span
              >
              <span class="js-keyword">const</span>
              <span class="js-method">loadFeature</span> =
              <span class="js-keyword">async</span> ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> { heavyFeature } =
              <span class="js-keyword">await</span>
              <span class="js-import">import</span>(<span class="js-string"
                >'./heavy-feature.js'</span
              >); <span class="js-keyword">return</span>
              <span class="js-method">heavyFeature</span>(); };

              <span class="js-comment">// Lazy loading components</span>
              <span class="js-keyword">const</span>
              <span class="js-method">LazyComponent</span> =
              <span class="js-keyword">async</span> ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> component =
              <span class="js-keyword">await</span>
              <span class="js-import">import</span>(<span class="js-string"
                >'./Component.js'</span
              >); <span class="js-keyword">return</span> component.<span
                class="js-keyword"
                >default</span
              >; };
            </div>
          </div>
        </div>

        <div class="interactive-demo">
          <h4>Dependency Analyzer</h4>
          <div class="controls">
            <textarea
              id="module-code"
              placeholder="Paste module code here..."
              rows="4"
            >
import { api } from './api.js';
import utils from './utils.js';
export const processData = (data) => utils.format(api.fetch(data));
                    </textarea
            >
            <button class="btn" onclick="analyzeModule()">
              Analyze Dependencies
            </button>
          </div>
          <div class="output" id="dependency-output"></div>
        </div>
      </div>

      <!-- Testing Framework -->
      <div class="demo-section">
        <h2>üß™ JavaScript Testing Fundamentals</h2>

        <div class="module-grid">
          <div class="module-card">
            <h3>Basic Test Structure</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// Simple assertion library</span>
              <span class="js-keyword">class</span>
              <span class="js-method">TestFramework</span> {
              <span class="js-method">constructor</span>() {
              <span class="js-keyword">this</span>.tests = [];
              <span class="js-keyword">this</span>.results = { passed:
              <span class="js-number">0</span>, failed:
              <span class="js-number">0</span>, skipped:
              <span class="js-number">0</span> }; }

              <span class="js-method">describe</span>(<span class="js-param"
                >suiteName</span
              >, <span class="js-param">callback</span>) { console.<span
                class="js-method"
                >group</span
              >(<span class="js-string">`üìã ${suiteName}`</span>);
              <span class="js-method">callback</span>(); console.<span
                class="js-method"
                >groupEnd</span
              >(); }

              <span class="js-method">it</span>(<span class="js-param"
                >testName</span
              >, <span class="js-param">testFunction</span>) {
              <span class="js-keyword">try</span> {
              <span class="js-method">testFunction</span>();
              <span class="js-keyword">this</span>.results.passed++;
              console.<span class="js-method">log</span>(<span class="js-string"
                >`‚úÖ ${testName}`</span
              >); } <span class="js-keyword">catch</span> (error) {
              <span class="js-keyword">this</span>.results.failed++;
              console.<span class="js-method">error</span>(<span
                class="js-string"
                >`‚ùå ${testName}: ${error.message}`</span
              >); } }

              <span class="js-method">expect</span>(<span class="js-param"
                >actual</span
              >) { <span class="js-keyword">return</span> {
              <span class="js-method">toBe</span>: (<span class="js-param"
                >expected</span
              >) <span class="js-operator">=></span> {
              <span class="js-keyword">if</span> (actual !== expected) {
              <span class="js-keyword">throw new</span>
              <span class="js-method">Error</span>(<span class="js-string"
                >`Expected ${expected}, got ${actual}`</span
              >); } }, <span class="js-method">toEqual</span>: (<span
                class="js-param"
                >expected</span
              >) <span class="js-operator">=></span> {
              <span class="js-keyword">if</span> (JSON.<span class="js-method"
                >stringify</span
              >(actual) !== JSON.<span class="js-method">stringify</span
              >(expected)) { <span class="js-keyword">throw new</span>
              <span class="js-method">Error</span>(<span class="js-string"
                >`Objects not equal`</span
              >); } } }; } }
            </div>
          </div>

          <div class="module-card">
            <h3>Testing Patterns</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// Test-Driven Development (TDD)</span>
              <span class="js-keyword">const</span> test =
              <span class="js-keyword">new</span>
              <span class="js-method">TestFramework</span>(); test.<span
                class="js-method"
                >describe</span
              >(<span class="js-string">'Math utilities'</span>, ()
              <span class="js-operator">=></span> { test.<span class="js-method"
                >it</span
              >(<span class="js-string">'should add two numbers'</span>, ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> result =
              <span class="js-method">add</span>(<span class="js-number">2</span
              >, <span class="js-number">3</span>); test.<span class="js-method"
                >expect</span
              >(result).<span class="js-method">toBe</span>(<span
                class="js-number"
                >5</span
              >); }); test.<span class="js-method">it</span>(<span
                class="js-string"
                >'should handle negative numbers'</span
              >, () <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> result =
              <span class="js-method">add</span>(-<span class="js-number"
                >2</span
              >, <span class="js-number">3</span>); test.<span class="js-method"
                >expect</span
              >(result).<span class="js-method">toBe</span>(<span
                class="js-number"
                >1</span
              >); }); test.<span class="js-method">it</span>(<span
                class="js-string"
                >'should throw on division by zero'</span
              >, () <span class="js-operator">=></span> {
              <span class="js-keyword">try</span> {
              <span class="js-method">divide</span>(<span class="js-number"
                >10</span
              >, <span class="js-number">0</span>);
              <span class="js-keyword">throw new</span>
              <span class="js-method">Error</span>(<span class="js-string"
                >'Expected an error'</span
              >); } <span class="js-keyword">catch</span> (error) { test.<span
                class="js-method"
                >expect</span
              >(error.message).<span class="js-method">toBe</span>(<span
                class="js-string"
                >'Division by zero'</span
              >); } }); });

              <span class="js-comment">// Async testing</span>
              test.<span class="js-method">it</span>(<span class="js-string"
                >'should handle async operations'</span
              >, <span class="js-keyword">async</span> ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> result =
              <span class="js-keyword">await</span>
              <span class="js-method">fetchData</span>(<span class="js-string"
                >'/api/test'</span
              >); test.<span class="js-method">expect</span
              >(result.status).<span class="js-method">toBe</span>(<span
                class="js-string"
                >'success'</span
              >); });
            </div>
          </div>
        </div>

        <div class="test-suite">
          <h3>Interactive Test Runner</h3>
          <div class="controls">
            <input
              type="text"
              id="function-to-test"
              placeholder="Function name"
              value="add"
            />
            <input
              type="text"
              id="test-input-a"
              placeholder="Input A"
              value="5"
            />
            <input
              type="text"
              id="test-input-b"
              placeholder="Input B"
              value="3"
            />
            <input
              type="text"
              id="expected-result"
              placeholder="Expected result"
              value="8"
            />
            <button class="btn" onclick="runSingleTest()">Run Test</button>
            <button class="btn btn-success" onclick="runTestSuite()">
              Run Full Suite
            </button>
          </div>

          <div id="test-results" class="test-results"></div>

          <div class="test-summary" id="test-summary">
            <h4>Test Results</h4>
            <div id="summary-stats">No tests run yet</div>
            <div class="coverage-bar">
              <div
                class="coverage-fill"
                id="coverage-fill"
                style="width: 0%"
              ></div>
            </div>
            <div id="coverage-text">Code Coverage: 0%</div>
          </div>
        </div>
      </div>

      <!-- Advanced Testing Concepts -->
      <div class="demo-section">
        <h2>üî¨ Advanced Testing Concepts</h2>

        <div class="module-grid">
          <div class="module-card">
            <h3>Mocking & Spies</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// Simple mock implementation</span>
              <span class="js-keyword">class</span>
              <span class="js-method">MockFunction</span> {
              <span class="js-method">constructor</span>(<span class="js-param"
                >returnValue</span
              >) { <span class="js-keyword">this</span>.calls = [];
              <span class="js-keyword">this</span>.returnValue = returnValue; }

              <span class="js-method">call</span>(...<span class="js-param"
                >args</span
              >) { <span class="js-keyword">this</span>.calls.<span
                class="js-method"
                >push</span
              >(args); <span class="js-keyword">return</span>
              <span class="js-keyword">this</span>.returnValue; }

              <span class="js-method">toHaveBeenCalledWith</span>(...<span
                class="js-param"
                >expectedArgs</span
              >) { <span class="js-keyword">return</span>
              <span class="js-keyword">this</span>.calls.<span class="js-method"
                >some</span
              >(<span class="js-param">callArgs</span>
              <span class="js-operator">=></span> JSON.<span class="js-method"
                >stringify</span
              >(callArgs) === JSON.<span class="js-method">stringify</span
              >(expectedArgs) ); }

              <span class="js-method">toHaveBeenCalledTimes</span>(<span
                class="js-param"
                >expectedCount</span
              >) { <span class="js-keyword">return</span>
              <span class="js-keyword">this</span>.calls.length ===
              expectedCount; } }

              <span class="js-comment">// Usage example</span>
              <span class="js-keyword">const</span> mockFetch =
              <span class="js-keyword">new</span>
              <span class="js-method">MockFunction</span>(<span
                class="js-string"
                >'mocked response'</span
              >);

              <span class="js-comment">// Test with mock</span>
              <span class="js-keyword">function</span>
              <span class="js-method">testApiCall</span>() {
              <span class="js-keyword">const</span> result = mockFetch.<span
                class="js-method"
                >call</span
              >(<span class="js-string">'/api/users'</span>);

              <span class="js-comment">// Assertions</span>
              console.<span class="js-method">assert</span>(mockFetch.<span
                class="js-method"
                >toHaveBeenCalledWith</span
              >(<span class="js-string">'/api/users'</span>)); console.<span
                class="js-method"
                >assert</span
              >(mockFetch.<span class="js-method">toHaveBeenCalledTimes</span
              >(<span class="js-number">1</span>)); console.<span
                class="js-method"
                >assert</span
              >(result === <span class="js-string">'mocked response'</span>); }
            </div>

            <div class="interactive-demo">
              <h4>Mock Function Tester</h4>
              <div class="controls">
                <input
                  type="text"
                  id="mock-return"
                  placeholder="Mock return value"
                  value="mocked result"
                />
                <input
                  type="text"
                  id="mock-args"
                  placeholder="Call arguments (comma-separated)"
                  value="arg1,arg2"
                />
                <button class="btn" onclick="testMockFunction()">
                  Test Mock
                </button>
              </div>
              <div class="output" id="mock-output"></div>
            </div>
          </div>

          <div class="module-card">
            <h3>Integration Testing</h3>
            <div class="code-block" data-lang="js">
              <span class="js-comment">// Integration test example</span>
              <span class="js-keyword">class</span>
              <span class="js-method">UserService</span> {
              <span class="js-method">constructor</span>(<span class="js-param"
                >apiClient</span
              >) { <span class="js-keyword">this</span>.apiClient = apiClient; }

              <span class="js-keyword">async</span>
              <span class="js-method">getUserProfile</span>(<span
                class="js-param"
                >userId</span
              >) { <span class="js-keyword">const</span> user =
              <span class="js-keyword">await</span>
              <span class="js-keyword">this</span>.apiClient.<span
                class="js-method"
                >get</span
              >(<span class="js-string">`/users/${userId}`</span>);
              <span class="js-keyword">const</span> preferences =
              <span class="js-keyword">await</span>
              <span class="js-keyword">this</span>.apiClient.<span
                class="js-method"
                >get</span
              >(<span class="js-string">`/users/${userId}/preferences`</span>);

              <span class="js-keyword">return</span> { ...user, preferences,
              displayName:
              <span class="js-string"
                >`${user.firstName} ${user.lastName}`</span
              >
              }; } }

              <span class="js-comment">// Integration test</span>
              test.<span class="js-method">describe</span>(<span
                class="js-string"
                >'UserService Integration'</span
              >, () <span class="js-operator">=></span> { test.<span
                class="js-method"
                >it</span
              >(<span class="js-string"
                >'should combine user data correctly'</span
              >, <span class="js-keyword">async</span> ()
              <span class="js-operator">=></span> {
              <span class="js-keyword">const</span> mockApi = {
              <span class="js-method">get</span>: (<span class="js-param"
                >url</span
              >) <span class="js-operator">=></span> {
              <span class="js-keyword">if</span> (url.<span class="js-method"
                >includes</span
              >(<span class="js-string">'/preferences'</span>)) {
              <span class="js-keyword">return</span> Promise.<span
                class="js-method"
                >resolve</span
              >({ theme: <span class="js-string">'dark'</span>, lang:
              <span class="js-string">'en'</span> }); }
              <span class="js-keyword">return</span> Promise.<span
                class="js-method"
                >resolve</span
              >({ id: <span class="js-number">1</span>, firstName:
              <span class="js-string">'John'</span>, lastName:
              <span class="js-string">'Doe'</span>
              }); } };

              <span class="js-keyword">const</span> service =
              <span class="js-keyword">new</span>
              <span class="js-method">UserService</span>(mockApi);
              <span class="js-keyword">const</span> profile =
              <span class="js-keyword">await</span> service.<span
                class="js-method"
                >getUserProfile</span
              >(<span class="js-number">1</span>); test.<span class="js-method"
                >expect</span
              >(profile.displayName).<span class="js-method">toBe</span>(<span
                class="js-string"
                >'John Doe'</span
              >); test.<span class="js-method">expect</span
              >(profile.preferences.theme).<span class="js-method">toBe</span
              >(<span class="js-string">'dark'</span>); }); });
            </div>
          </div>
        </div>
      </div>

      <!-- Best Practices -->
      <div class="tip-box">
        <h4>üì¶ Module & Testing Best Practices</h4>
        <ul>
          <li>
            <strong>Use named exports for multiple exports:</strong> Makes
            imports explicit and clear
          </li>
          <li>
            <strong>Prefer default exports for single-purpose modules:</strong>
            Cleaner import syntax
          </li>
          <li>
            <strong>Avoid circular dependencies:</strong> Extract shared code to
            separate modules
          </li>
          <li>
            <strong>Write tests first (TDD):</strong> Leads to better design and
            fewer bugs
          </li>
          <li>
            <strong>Mock external dependencies:</strong> Keep unit tests fast
            and isolated
          </li>
          <li>
            <strong>Test edge cases and error conditions:</strong> Not just the
            happy path
          </li>
          <li>
            <strong>Use descriptive test names:</strong> Tests serve as
            documentation
          </li>
          <li>
            <strong>Keep tests simple and focused:</strong> One assertion per
            test when possible
          </li>
        </ul>
      </div>
    </div>

    <!-- Universal Code Formatter -->
    <script src="../codemirror-integration.js"></script>

    <script>
      // Mock math functions for testing
      const mathFunctions = {
        add: (a, b) => a + b,
        subtract: (a, b) => a - b,
        multiply: (a, b) => a * b,
        divide: (a, b) => {
          if (b === 0) throw new Error('Division by zero');
          return a / b;
        },
      };

      // Simple test framework implementation
      class SimpleTestFramework {
        constructor() {
          this.tests = [];
          this.results = { passed: 0, failed: 0, skipped: 0 };
        }

        describe(suiteName, callback) {
          this.currentSuite = suiteName;
          callback();
        }

        it(testName, testFunction) {
          try {
            if (typeof testFunction === 'function') {
              testFunction();
              this.results.passed++;
              return { status: 'pass', name: testName, error: null };
            } else {
              this.results.skipped++;
              return { status: 'skip', name: testName, error: null };
            }
          } catch (error) {
            this.results.failed++;
            return { status: 'fail', name: testName, error: error.message };
          }
        }

        expect(actual) {
          return {
            toBe: (expected) => {
              if (actual !== expected) {
                throw new Error(`Expected ${expected}, got ${actual}`);
              }
            },
            toEqual: (expected) => {
              if (JSON.stringify(actual) !== JSON.stringify(expected)) {
                throw new Error(
                  `Objects not equal. Expected ${JSON.stringify(
                    expected
                  )}, got ${JSON.stringify(actual)}`
                );
              }
            },
            toThrow: () => {
              if (typeof actual !== 'function') {
                throw new Error('Expected a function that throws');
              }
              try {
                actual();
                throw new Error('Expected function to throw an error');
              } catch (e) {
                // Expected to throw
              }
            },
          };
        }

        getResults() {
          return this.results;
        }

        reset() {
          this.results = { passed: 0, failed: 0, skipped: 0 };
        }
      }

      const testFramework = new SimpleTestFramework();

      // Module generation
      function generateModule() {
        const moduleName =
          document.getElementById('module-name').value || 'myModule';
        const exportType = document.getElementById('export-type').value;
        const output = document.getElementById('module-output');

        let moduleCode = '';
        let importCode = '';

        switch (exportType) {
          case 'named':
            moduleCode = `// ${moduleName}.js - Named Exports
export const function1 = () => 'Function 1';
export const function2 = () => 'Function 2';
export const CONSTANT = 'module constant';

const internalFunction = () => 'internal';
export { internalFunction as exposed };`;

            importCode = `// Importing from ${moduleName}.js
import { function1, function2, CONSTANT } from './${moduleName}.js';
import { exposed as internal } from './${moduleName}.js';

// Usage
console.log(function1()); // 'Function 1'
console.log(CONSTANT);    // 'module constant'`;
            break;

          case 'default':
            moduleCode = `// ${moduleName}.js - Default Export
class ${moduleName.charAt(0).toUpperCase() + moduleName.slice(1)} {
    constructor(config = {}) {
        this.config = config;
    }
    
    process(data) {
        return \`Processing \${data} with \${this.config.mode || 'default'} mode\`;
    }
}

export default ${moduleName.charAt(0).toUpperCase() + moduleName.slice(1)};`;

            importCode = `// Importing from ${moduleName}.js
import ${
              moduleName.charAt(0).toUpperCase() + moduleName.slice(1)
            } from './${moduleName}.js';

// Usage
const instance = new ${
              moduleName.charAt(0).toUpperCase() + moduleName.slice(1)
            }({ mode: 'advanced' });
console.log(instance.process('data'));`;
            break;

          case 'mixed':
            moduleCode = `// ${moduleName}.js - Mixed Exports
export const VERSION = '1.0.0';
export const helper = (input) => input.toUpperCase();

class MainClass {
    constructor() {
        this.version = VERSION;
    }
    
    transform(data) {
        return helper(data);
    }
}

export default MainClass;
export { MainClass as ${
              moduleName.charAt(0).toUpperCase() + moduleName.slice(1)
            }Class };`;

            importCode = `// Importing from ${moduleName}.js
import MainClass, { VERSION, helper } from './${moduleName}.js';
import { ${
              moduleName.charAt(0).toUpperCase() + moduleName.slice(1)
            }Class } from './${moduleName}.js';

// Usage
const main = new MainClass();
console.log(main.transform('hello')); // Uses helper internally
console.log(VERSION); // '1.0.0'`;
            break;
        }

        output.innerHTML = `
                <div class="output-line success">Generated ${exportType} module: ${moduleName}.js</div>
                <div class="output-line info">Module Code:</div>
                <pre style="background: #0d1117; padding: 15px; border-radius: 6px; margin: 10px 0; overflow-x: auto;">${moduleCode}</pre>
                <div class="output-line info">Import Code:</div>
                <pre style="background: #0d1117; padding: 15px; border-radius: 6px; margin: 10px 0; overflow-x: auto;">${importCode}</pre>
            `;
      }

      // Dependency analysis
      function analyzeModule() {
        const code = document.getElementById('module-code').value;
        const output = document.getElementById('dependency-output');

        if (!code.trim()) {
          output.innerHTML =
            '<div class="output-line error">Please enter some module code</div>';
          return;
        }

        // Simple regex-based analysis (in real scenarios, use proper parsers)
        const importRegex =
          /import\s+(?:(?:\{[^}]+\}|\*\s+as\s+\w+|\w+)(?:\s*,\s*\{[^}]+\})?\s+from\s+)?['"]([^'"]+)['"]/g;
        const exportRegex =
          /export\s+(?:default\s+)?(?:class\s+\w+|function\s+\w+|const\s+\w+|let\s+\w+|var\s+\w+|\{[^}]+\})/g;

        const imports = [];
        const exports = [];
        let match;

        // Find imports
        while ((match = importRegex.exec(code)) !== null) {
          imports.push(match[1]);
        }

        // Find exports
        while ((match = exportRegex.exec(code)) !== null) {
          exports.push(match[0]);
        }

        const isCircular = imports.some(
          (imp) => imp.includes('./') && !imp.includes('node_modules')
        );

        output.innerHTML = `
                <div class="output-line success">Dependency Analysis Complete</div>
                
                <div class="output-line info">üì• Imports Found (${
                  imports.length
                }):</div>
                ${imports
                  .map((imp) => `<div class="output-line">  ‚Ä¢ ${imp}</div>`)
                  .join('')}
                
                <div class="output-line info">üì§ Exports Found (${
                  exports.length
                }):</div>
                ${exports
                  .map(
                    (exp) =>
                      `<div class="output-line">  ‚Ä¢ ${exp.substring(0, 50)}${
                        exp.length > 50 ? '...' : ''
                      }</div>`
                  )
                  .join('')}
                
                <div class="output-line ${isCircular ? 'warning' : 'success'}">
                    ${
                      isCircular
                        ? '‚ö†Ô∏è Potential circular dependency detected'
                        : '‚úÖ No obvious circular dependencies'
                    }
                </div>
                
                <div class="output-line info">üí° Recommendations:</div>
                ${
                  imports.length > 5
                    ? '<div class="output-line warning">  ‚Ä¢ Consider reducing import count for better bundling</div>'
                    : ''
                }
                ${
                  imports.some(
                    (imp) => imp.includes('lodash') && !imp.includes('/')
                  )
                    ? '<div class="output-line warning">  ‚Ä¢ Use specific lodash imports for better tree-shaking</div>'
                    : ''
                }
                <div class="output-line">  ‚Ä¢ Use static analysis tools like ESLint for deeper analysis</div>
            `;
      }

      // Single test runner
      function runSingleTest() {
        const functionName = document.getElementById('function-to-test').value;
        const inputA =
          parseFloat(document.getElementById('test-input-a').value) || 0;
        const inputB =
          parseFloat(document.getElementById('test-input-b').value) || 0;
        const expected =
          parseFloat(document.getElementById('expected-result').value) || 0;

        if (!mathFunctions[functionName]) {
          document.getElementById('test-results').innerHTML =
            '<div class="test-result fail">‚ùå Function not found: ' +
            functionName +
            '</div>';
          return;
        }

        try {
          const actual = mathFunctions[functionName](inputA, inputB);
          const passed = actual === expected;

          const resultClass = passed ? 'pass' : 'fail';
          const icon = passed ? '‚úÖ' : '‚ùå';

          document.getElementById('test-results').innerHTML = `
                    <div class="test-result ${resultClass}">
                        <span>${icon} ${functionName}(${inputA}, ${inputB})</span>
                        <span>Expected: ${expected}, Got: ${actual}</span>
                    </div>
                `;

          updateTestSummary(passed ? 1 : 0, passed ? 0 : 1, 0);
        } catch (error) {
          document.getElementById('test-results').innerHTML = `
                    <div class="test-result fail">
                        <span>‚ùå ${functionName}(${inputA}, ${inputB})</span>
                        <span>Error: ${error.message}</span>
                    </div>
                `;
          updateTestSummary(0, 1, 0);
        }
      }

      // Full test suite runner
      function runTestSuite() {
        const output = document.getElementById('test-results');
        output.innerHTML =
          '<div class="output-line info">Running full test suite...</div>';

        testFramework.reset();
        const results = [];

        // Define test cases
        const testCases = [
          {
            name: 'add positive numbers',
            fn: 'add',
            args: [2, 3],
            expected: 5,
          },
          {
            name: 'add negative numbers',
            fn: 'add',
            args: [-2, -3],
            expected: -5,
          },
          {
            name: 'subtract numbers',
            fn: 'subtract',
            args: [10, 4],
            expected: 6,
          },
          {
            name: 'multiply numbers',
            fn: 'multiply',
            args: [6, 7],
            expected: 42,
          },
          { name: 'divide numbers', fn: 'divide', args: [15, 3], expected: 5 },
          {
            name: 'divide by zero (should throw)',
            fn: 'divide',
            args: [10, 0],
            shouldThrow: true,
          },
        ];

        // Run tests with delay for animation
        let currentTest = 0;
        const runNextTest = () => {
          if (currentTest >= testCases.length) {
            const { passed, failed, skipped } = testFramework.getResults();
            updateTestSummary(passed, failed, skipped);
            return;
          }

          const testCase = testCases[currentTest];
          const result = testFramework.it(testCase.name, () => {
            if (testCase.shouldThrow) {
              testFramework
                .expect(() => mathFunctions[testCase.fn](...testCase.args))
                .toThrow();
            } else {
              const actual = mathFunctions[testCase.fn](...testCase.args);
              testFramework.expect(actual).toBe(testCase.expected);
            }
          });

          const resultClass =
            result.status === 'pass'
              ? 'pass'
              : result.status === 'fail'
              ? 'fail'
              : 'skip';
          const icon =
            result.status === 'pass'
              ? '‚úÖ'
              : result.status === 'fail'
              ? '‚ùå'
              : '‚è≠Ô∏è';

          output.innerHTML += `
                    <div class="test-result ${resultClass}">
                        <span>${icon} ${testCase.name}</span>
                        <span>${result.error || 'Passed'}</span>
                    </div>
                `;

          currentTest++;
          setTimeout(runNextTest, 300); // Delay for visual effect
        };

        runNextTest();
      }

      // Mock function testing
      function testMockFunction() {
        const returnValue =
          document.getElementById('mock-return').value || 'default';
        const args = document
          .getElementById('mock-args')
          .value.split(',')
          .map((s) => s.trim());
        const output = document.getElementById('mock-output');

        // Create mock function
        class MockFunction {
          constructor(returnValue) {
            this.calls = [];
            this.returnValue = returnValue;
          }

          call(...args) {
            this.calls.push(args);
            return this.returnValue;
          }

          toHaveBeenCalledWith(...expectedArgs) {
            return this.calls.some(
              (callArgs) =>
                JSON.stringify(callArgs) === JSON.stringify(expectedArgs)
            );
          }

          toHaveBeenCalledTimes(expectedCount) {
            return this.calls.length === expectedCount;
          }
        }

        const mockFn = new MockFunction(returnValue);

        // Test the mock
        const result1 = mockFn.call(...args);
        const result2 = mockFn.call('another', 'call');

        output.innerHTML = `
                <div class="output-line success">Mock Function Test Results:</div>
                <div class="output-line">First call result: ${result1}</div>
                <div class="output-line">Second call result: ${result2}</div>
                <div class="output-line info">Mock Assertions:</div>
                <div class="output-line ${
                  mockFn.toHaveBeenCalledWith(...args) ? 'success' : 'error'
                }">
                    ‚úì Called with [${args.join(
                      ', '
                    )}]: ${mockFn.toHaveBeenCalledWith(...args)}
                </div>
                <div class="output-line ${
                  mockFn.toHaveBeenCalledTimes(2) ? 'success' : 'error'
                }">
                    ‚úì Called 2 times: ${mockFn.toHaveBeenCalledTimes(2)}
                </div>
                <div class="output-line info">Call history:</div>
                ${mockFn.calls
                  .map(
                    (call, index) =>
                      `<div class="output-line">  ${index + 1}. [${call.join(
                        ', '
                      )}]</div>`
                  )
                  .join('')}
            `;
      }

      // Update test summary
      function updateTestSummary(passed, failed, skipped) {
        const total = passed + failed + skipped;
        const successRate = total > 0 ? (passed / total) * 100 : 0;

        document.getElementById('summary-stats').innerHTML = `
                <div style="display: flex; justify-content: space-around; margin: 10px 0;">
                    <span class="success">‚úÖ Passed: ${passed}</span>
                    <span class="error">‚ùå Failed: ${failed}</span>
                    <span class="warning">‚è≠Ô∏è Skipped: ${skipped}</span>
                </div>
            `;

        document.getElementById(
          'coverage-fill'
        ).style.width = `${successRate}%`;
        document.getElementById(
          'coverage-text'
        ).textContent = `Test Success Rate: ${successRate.toFixed(1)}%`;
      }

      function clearOutput(elementId) {
        document.getElementById(elementId).innerHTML = '';
      }

      // Code formatting is now handled by universal-code-formatter.js

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', function () {
        console.log('üì¶ JavaScript Modules & Testing Demo loaded!');
        console.log(
          'Explore ES6 modules, dependency management, and testing frameworks!'
        );
        
        // Code formatting is automatically handled by universal-code-formatter.js
      });
    </script>
  </body>
</html>
